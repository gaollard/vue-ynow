webpackJsonp([3],{"+yCD":function(e,t){},"/ReL":function(e,t,r){"use strict";var n=r("lC5x"),a=r.n(n),i=(r("GHWT"),r("1yQd")),o=r("J0Oq"),c=r.n(o),s=(r("H+w4"),r("Qyky")),l=(r("9lm5"),r("gyQz")),u=(r("FeyD"),r("1CtW")),d=r("/xf8"),f=r("MqhK");d.default.use(s.a).use(l.a).use(u.a);var m={props:{value:{type:Boolean,default:!1}},data:function(){return{list:[],loading:!1,index:1}},watch:{value:function(e){console.log(e)}},mounted:function(){var e=this;return c()(a.a.mark(function t(){var r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,f.a.getXzCategorytList();case 4:0==+(r=t.sent).retCode?e.list=r.data.list:Object(i.a)(r.errMsg),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.log(t.t0);case 11:e.loading=!1;case 12:case"end":return t.stop()}},t,e,[[1,8]])}))()},methods:{onCancel:function(){this.$emit("on-cancel")},onConfirm:function(e){this.$emit("on-confirm",e)}}},h={render:function(){var e=this.$createElement,t=this._self._c||e;return this.value?t("div",{staticClass:"popup"},[t("van-picker",{ref:"picker",staticClass:"picker",attrs:{"show-toolbar":"",title:"选择分类",loading:this.loading,columns:this.list,"defualt-index":3,"value-key":"name"},on:{cancel:this.onCancel,confirm:this.onConfirm}})],1):this._e()},staticRenderFns:[]};var p=r("C7Lr")(m,h,!1,function(e){r("wOyF")},"data-v-54b8f486",null);t.a=p.exports},"36TX":function(e,t,r){"use strict";r("H+w4");var n=r("Qyky"),a=(r("9lm5"),r("gyQz")),i=(r("FeyD"),r("1CtW")),o=r("/xf8"),c=r("T/88");o.default.use(n.a).use(a.a).use(i.a);var s={props:{value:{type:Boolean,default:!1},defaultIndex:{type:Number,default:0}},data:function(){return{columns:c.b,loading:!1}},methods:{onCancel:function(){this.$emit("on-cancel")},onConfirm:function(e){this.$emit("on-confirm",e)}}},l={render:function(){var e=this.$createElement,t=this._self._c||e;return this.value?t("div",{staticClass:"popup"},[t("van-picker",{staticClass:"picker",attrs:{"show-toolbar":"",title:"选择分类",loading:this.loading,columns:this.columns,"value-key":"name"},on:{cancel:this.onCancel,confirm:this.onConfirm}})],1):this._e()},staticRenderFns:[]};var u=r("C7Lr")(s,l,!1,function(e){r("+yCD")},"data-v-02b3776e",null);t.a=u.exports},"5p2U":function(e,t){},EZyW:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAB10lEQVRYR+2WzUrEMBSF721kfAzb5DVEXerCERyVEXGh7zEb30MQRB38GVBBdOHKx5Amr6GDzZUMrQyhbZKOOgrTZX9yvpyce28RpnzhlPVhBvA3HZBSLhBRL4qiqyRJnibJiZRyiYgOGGNHcRwre61SB9I0PQaAQwAgRNzhnF83gVBKrWZZdo+IcwDQF0Ls+gIsEtEzIrYAIEPEbihELn7rWqMyAxa9gdjknN/5OOErbtaqDaGUsq21vjEWEtFHFEUdF0SIuBPAvGAgiGgAAMxAMMbWkyR5LHPCEvfKj1cZSim3iKifQwwZYxs2hC0OAPtCiDPXkXkB5E5UQjQV9zqC8R3kTlya7BDREADWGGOtLMuKtJPvzot1vR0oPkjTdA8ATvMAvxFRlJdasHiwAxUQ5nYj8f8JMH4ERPQ+2gXifFMXgjJgiY/K0QD8SgjLxIte8ONlWCdeBLMphPMIfMSrIHxGuWsYme731XjKWrDdar9tGPn0/6o+XzLKK/8nSh2QUm4T0UXd8HENmfFRbgoFANpCiAffPyIj3jX93sf2KhgLYiCE6HgBKKVirXUPEU845y+u3dY9V0ota61XAOBcCPHqBTCJYOi3zjIMXTD0/RnA1B34BHm/azB96WW0AAAAAElFTkSuQmCC"},I8yz:function(e,t,r){"use strict";var n=r("hU59"),a=(r.n(n),r("5p2U"));r.n(a)},KiDw:function(e,t){},OBs8:function(e,t){},TUz1:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("3cXf"),a=r.n(n),i=r("lC5x"),o=r.n(i),c=(r("GHWT"),r("1yQd")),s=r("J0Oq"),l=r.n(s),u=r("4YfN"),d=r.n(u),f=(r("4way"),r("lFAY")),m=(r("TNZe"),r("o0ft")),h=(r("I8yz"),r("QXwt")),p=(r("A8o8"),r("qGRE")),v=(r("k5uY"),r("kReC")),g=(r("pkmQ"),r("p8HH")),y=(r("7cF9"),r("3UBn")),k=(r("ocLK"),r("gFtn")),C=r("/xf8"),A=r("R4Sj"),w=r("MqhK"),x=r("kqgM"),b=r("xgXK"),I=r("/ReL"),E=r("36TX"),P=r("T/88");C.default.use(f.a).use(m.a).use(h.a).use(p.a).use(v.a).use(g.a).use(y.a).use(k.a);var L={components:{cityPicker:b.a,categoryPicker:I.a,tradeWayPicker:E.a},data:function(){return{checked:"",form:{reward:"",title:"",city:"",description:"",requires:"",categoryId:"",categoryName:"",tradeWayId:"",tradeWayName:""},pickList:[],token:"",categoryValue:null,showCategoryPicker:!1,tradeWayPickerValue:null,showTradeWayPicker:!1,cityPickerValue:null,showCityPicker:!1,errors:[],showFormError:!1}},computed:d()({},Object(A.b)({categoryList:function(e){return e.xzProduct.category.list}}),{tradeWayName:function(){var e=this,t=P.b.findIndex(function(t){return+t.id==+e.form.tradeWayId});return-1!==t?P.b[t].name:""},categoryName:function(){var e=this,t=this.categoryList.findIndex(function(t){return+t.id==+e.form.categoryId});return-1!==t?this.categoryList[t].name:""}}),mounted:function(){this.doGet7nToken(),this.$route.query.itemId&&this.doGetXzProductItem(),this.categoryList.length||this.$store.dispatch("xzProduct/getCategory")},methods:{onRead:function(e){this.pickList.push(e),this.uploadImg(this.pickList.length-1,e.file)},removeItem:function(e){this.pickList.splice(e,1)},doGet7nToken:function(){var e=this;return l()(o.a.mark(function t(){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,w.a.get7nToken();case 3:0==+(r=t.sent).errCode?e.token=r.data.token:Object(c.a)(r.errMsg),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},doGetXzProductItem:function(){var e=this;return l()(o.a.mark(function t(){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,w.a.getXzProductItem(e.$route.query.itemId);case 3:0==+(r=t.sent).retCode?(e.itemInfo=r.data,e.form.reward=+e.itemInfo.reward/100,e.form.title=e.itemInfo.title,e.form.city=e.itemInfo.city,e.form.description=e.itemInfo.description,e.form.requires=e.itemInfo.requires,e.form.categoryId=e.itemInfo.category_id,e.form.tradeWayId=e.itemInfo.trade_way_id,e.pickList=e.itemInfo.imgs.map(function(e){return{url:e,content:e,percent:100}})):Object(c.a)(r.errMsg),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},uploadImg:function(e,t,r){var n=this;x.upload(t,t.name,this.token,{},{}).subscribe({next:function(t){n.pickList[e].percent=t.total.percent,n.pickList=[].concat(n.pickList)},error:function(e){Object(c.a)(e)},complete:function(t){n.pickList[e].url="//c1.airtlab.com/"+t.key,n.pickList=[].concat(n.pickList)}})},doCreate:function(){var e=this;return l()(o.a.mark(function t(){var r,n,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=e.pickList.map(function(e){return e.url}),r=a()(r),n=d()({},e.form,{imgs:r,reward:100*+e.form.reward}),console.log(n),t.next=7,w.a.createDemand(n);case 7:0==+(i=t.sent).errCode?c.a.success("发布成功"):Object(c.a)(i.errMsg),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0);case 14:case"end":return t.stop()}},t,e,[[0,11]])}))()},doUpdateProduct:function(){var e=this;return l()(o.a.mark(function t(){var r,n,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=e.pickList.map(function(e){return e.url}),r=a()(r),n=d()({},e.form,{imgs:r,itemId:e.$route.query.itemId,reward:100*+e.form.reward}),t.next=6,w.a.updateXzProduct(n);case 6:0==+(i=t.sent).errCode?c.a.success("发布成功"):Object(c.a)(i.errMsg),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0);case 13:case"end":return t.stop()}},t,e,[[0,10]])}))()},handleSubmit:function(){var e=this.form,t=[];e.title.length<5&&t.push("标题长度不能小于5"),0===e.reward.length&&t.push("价格不能为空"),0===e.city.length&&t.push("宝贝所在城市不能为空"),this.errors=t,this.showFormError=!!t.length,this.showFormError||this.doCreate()},onCategoryChange:function(e){this.categoryValue=e,this.form.categoryId=e.id,this.form.categoryName=e.name,this.showCategoryPicker=!1},onTradeWayChange:function(e){this.tradeWayPickerValue=e,this.form.tradeWayId=e.id,this.form.tradeWayName=e.name,this.showTradeWayPicker=!1},onCityChange:function(e){this.cityPickerValue=e;var t=[];e.forEach(function(e){t.push(e.name)}),this.form.city=t.join(" ")}}},B={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"view"},[n("van-nav-bar",{attrs:{title:"发布需求","left-text":"返回","left-arrow":""},on:{"click-left":function(t){e.$router.go(-1)}}}),e._v(" "),n("div",{staticClass:"content"},[n("van-field",{attrs:{placeholder:"标题(搜索的关键词)"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}}),e._v(" "),n("van-field",{attrs:{placeholder:"悬赏金额(单位为元)"},model:{value:e.form.reward,callback:function(t){e.$set(e.form,"reward",t)},expression:"form.reward"}}),e._v(" "),n("van-field",{attrs:{placeholder:"您对竞标者的要求"},model:{value:e.form.requires,callback:function(t){e.$set(e.form,"requires",t)},expression:"form.requires"}}),e._v(" "),n("van-field",{attrs:{placeholder:"需求描述",type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}}),e._v(" "),n("van-field",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{placeholder:"分类(有助于快速筛选)",readonly:!0,"is-link":!0},nativeOn:{click:function(t){e.showCategoryPicker=!0}},model:{value:e.categoryName,callback:function(t){e.categoryName=t},expression:"categoryName"}}),e._v(" "),n("van-field",{attrs:{placeholder:"完成需求所在的城市",readonly:!0,"is-link":!0},nativeOn:{click:function(t){e.showCityPicker=!0}},model:{value:e.form.city,callback:function(t){e.$set(e.form,"city",t)},expression:"form.city"}}),e._v(" "),n("div",{staticClass:"upload-wrap"},[e._l(e.pickList,function(t,a){return n("div",{key:a,staticClass:"preview-box"},[n("img",{staticClass:"pre-item",attrs:{src:t.content}}),e._v(" "),n("div",{on:{click:function(t){e.removeItem(a)}}},[n("div",[e._v("%"+e._s(t.percent))]),e._v(" "),n("img",{staticClass:"icon-remove",attrs:{src:r("EZyW"),alt:"图片"}})])])}),e._v(" "),n("van-uploader",{staticClass:"touch-area",attrs:{"after-read":e.onRead}},[[n("img",{staticClass:"icon-add",attrs:{src:r("Usqs")}})]],2)],2),e._v(" "),n("van-cell",{staticClass:"ui-flex",attrs:{title:"是否上架"}},[n("van-switch",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}})],1)],1),e._v(" "),n("van-button",{staticClass:"btm-fixed",attrs:{size:"large",type:"primary"},on:{click:e.handleSubmit}},[e._v("提交")]),e._v(" "),n("categoryPicker",{on:{"on-confirm":e.onCategoryChange,"on-cancel":function(t){e.showCategoryPicker=!1}},model:{value:e.showCategoryPicker,callback:function(t){e.showCategoryPicker=t},expression:"showCategoryPicker"}}),e._v(" "),n("cityPicker",{on:{"on-confirm":e.onCityChange},model:{value:e.showCityPicker,callback:function(t){e.showCityPicker=t},expression:"showCityPicker"}}),e._v(" "),n("van-dialog",{attrs:{title:"您提交的参数不规范"},model:{value:e.showFormError,callback:function(t){e.showFormError=t},expression:"showFormError"}},[n("ul",{staticClass:"error-list"},e._l(e.errors,function(t,r){return n("li",{key:r},[e._v(e._s(r+1)+". "+e._s(t))])}),0)])],1)},staticRenderFns:[]};var _=r("C7Lr")(L,B,!1,function(e){r("KiDw")},"data-v-70d4f3a0",null);t.default=_.exports},Usqs:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAA0klEQVR4Xu3bwQ3CQAxE0dla0gY3mkKcuKUqbrThWkAo6WGQeGnAkZXd/D+yV0rPzOxJbmf5fdu2e+NVVqPot6YG+AIcAXeAS9BfwG8QBwChowNIEApzATLEBhtmSocbXZcHCEQkQiIxmaBMUCYoE5QJygRlgjLBeiY4M4+SEF2TXM7aryTPxnusmXk3Cv9KTQ34+yPQ+hTJEBkiQ2SIDJEhMkSG6jIEhEodQIJIEAkiQSSIBJEgEkSCRmXNChuWNi1uXN6+gIUJCxMWJixMVBYmPpG4ParnMh3BAAAAAElFTkSuQmCC"},wOyF:function(e,t){},xgXK:function(e,t,r){"use strict";var n=r("3cXf"),a=r.n(n),i=(r("9lm5"),r("gyQz")),o=(r("FeyD"),r("1CtW")),c=r("/xf8"),s=r("MqhK");c.default.use(i.a).use(o.a);var l={props:{value:{type:Boolean,default:!1}},data:function(){return{loading:!0,columnNum:3,columns:[]}},mounted:function(){var e=this;s.a.getSfCityList().then(function(t){var r=t.data.list;r=a()(r).replace(/areaId/g,"value").replace(/areaName/g,"name").replace(/children/g,"children").replace(/id/g,"value"),r=JSON.parse(r),e.loading=!1,e.list=r,e.initCityList()})},methods:{onChange:function(e,t,r){this.picker=e,t[r].children&&t[r].children.length&&this.rawIndex(r+1,t[r].children)},initCityList:function(){for(var e=0;e<this.columnNum;e++)this.columns[e]={values:[],defaultIndex:0};this.rawIndex(0,this.list)},rawIndex:function(e,t){e!==this.columnNum&&(this.picker?this.picker.setColumnValues(e,t):this.columns[e].values=t,t.length&&t[0].children&&t[0].children.length?this.rawIndex(e+1,t[0].children):this.rawIndex(e+1,[]))},onCancel:function(e){this.$emit("input",!1)},onConfirm:function(e){this.$emit("on-confirm",e),this.$emit("input",!1)}}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("van-popup",{attrs:{position:"bottom"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[r("van-picker",{attrs:{columns:e.columns,loading:e.loading,"show-toolbar":"",title:"选择地址","value-key":"name"},on:{change:e.onChange,cancel:e.onCancel,confirm:e.onConfirm}})],1)},staticRenderFns:[]};var d=r("C7Lr")(l,u,!1,function(e){r("OBs8")},"data-v-b651f70c",null);t.a=d.exports}});
//# sourceMappingURL=3.9619d4837a4fa6334f03.js.map